<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Rabbit{% endblock %}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/mdb.min.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/style.min.css' %}"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    {% block links %} {% endblock %}
</head>
<body>
<nav class="navbar navbar-dark white">
  <a class="navbar-brand" >
     <i class="fas fa-registered fa-2x prefix text-info"></i>
  </a>

    {% if not request.user.is_authenticated %}
        <button class="btn btn-primary btn-sm my-0 rounded-pill" type="button" onclick="modal_register()">
            Sign up
        </button>
        <button class="btn btn-primary btn-sm my-0 rounded-pill" type="button" onclick="modal_login()">
            Login
        </button>
        {% else %}
        <p class="mt-3">Hello, <b>{{ request.user.username }}</b>!</p>
    {% endif %}
</nav>

<div class="modal fade" id="modalRegisterForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
</div>

<div class="modal fade" id="modalLoginForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
</div>

{% block content-body %}
{% endblock %}
</body>
<script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/mdb.min.js' %}"></script>
<script type="text/javascript">

    let modalLoginLoaded = false;
    let modalRegisterLoaded = false;
    let modalRegister = $('#modalRegisterForm');
    let modalLogin = $('#modalLoginForm');
    function modal_register(){
        if(modalRegisterLoaded){
            modalRegister.modal('show');
        }
        else{
            $.ajax({
                method: 'GET',
                url: "{% url 'register' %}",
                success: (data) => {
                    modalRegister.html(data);
                    $('#modalRegisterForm').modal('show');
                    modalRegisterLoaded = true;
                }
            });
        }
    }

    function modal_login(){
        if(modalLoginLoaded){
            modalLogin.modal('show');
        }
        else{
            $.ajax({
                method: 'GET',
                url: "{% url 'login' %}",
                success: (data) => {
                    modalLogin.html(data);
                    modalLogin.modal('show');
                    modalLoginLoaded = true;
                }
            });
        }
    }

</script>

</html>